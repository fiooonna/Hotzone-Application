{"ast":null,"code":"import _toConsumableArray from\"/Users/johnny/hotzone/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/johnny/hotzone/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/johnny/hotzone/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/johnny/hotzone/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/johnny/hotzone/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import React,{useEffect,useState}from\"react\";import{render}from\"react-dom\";import{createUseStyles}from\"react-jss\";import cn from\"classnames\";import{useRootState}from\"@/App.js\";import{request}from\"@/request.js\";import ClickAway from\"@/components/Utils/ClickAway\";import _ from\"lodash\";var useInputFormStyle=createUseStyles({root:{width:\"100%\",display:\"flex\",flexDirection:\"column\",justifyContent:\"flex-start\",paddingLeft:30,position:\"relative\"},selectionTitle:{width:\"100%\",fontSize:40,borderBottom:\"1px solid black\",fontWeight:500,marginBottom:10},selectionField:{display:\"flex\"},selectionLabel:{fontSize:20},nextPage:{cursor:\"pointer\",textDecoration:\" underline\",position:\"absolute\",bottom:0,right:20},searchBtn:{marginLeft:10,cursor:\"pointer\"},locationBox:{},backBtn:{marginTop:20,width:60,height:40,color:\"black\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",fontWeight:\"bold\",cursor:\"pointer\",fontSize:15,borderRadius:5,position:\"absolute\",left:0,border:\"1px solid black\"},submitBtn:{marginTop:20,width:60,height:40,color:\"black\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",fontWeight:\"bold\",cursor:\"pointer\",fontSize:15,borderRadius:5,position:\"absolute\",right:30,border:\"1px solid black\"},addBtn:{marginTop:20,width:150,height:40,color:\"white\",backgroundColor:\"black\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",fontWeight:\"bold\",cursor:\"pointer\",fontSize:18,borderRadius:5},closeBtn:{cursor:\"pointer\"},searchContainer:{position:\"relative\"},BtnContainer:{display:\"flex\",justifyContent:\"center\",position:\"relative\"},resultRow:{display:\"flex\",flexDirection:\"column\",border:\"1px solid black\",cursor:\"pointer\",\"&:hover\":{backgroundColor:\"grey\"}},placeName:{fontWeight:\"bold\"},address:{fontSize:13},dropDown:{position:\"absolute\",maxHeight:500,overflowY:\"scroll\",display:\"flex\",flexDirection:\"column\",border:\"1px solid black\",backgroundColor:\"white\",\"& > div\":{paddingLeft:10},zIndex:1}});var LocationRecord=function LocationRecord(props){var classes=useInputFormStyle();var _useState=useState(props.data.category),_useState2=_slicedToArray(_useState,2),category=_useState2[0],setCategory=_useState2[1];var _useState3=useState(props.data.dateFrom),_useState4=_slicedToArray(_useState3,2),dateFrom=_useState4[0],setDateFrom=_useState4[1];var _useState5=useState(props.data.dateTo),_useState6=_slicedToArray(_useState5,2),dateTo=_useState6[0],setDateTo=_useState6[1];var _useState7=useState(props.data.location?props.data.location.nameEN:\"\"),_useState8=_slicedToArray(_useState7,2),searchTerm=_useState8[0],setSearchTerm=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),result=_useState10[0],setResult=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),deleted=_useState12[0],setDeleted=_useState12[1];var _useState13=useState(props.data.location),_useState14=_slicedToArray(_useState13,2),selectLocation=_useState14[0],setSelectLocation=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),location=_useState16[0],setLocation=_useState16[1];var onDateFromChange=function onDateFromChange(value){if(category===\"Visit\"){setDateTo(value);}if(value>dateTo&&dateTo!==\"\"){alert(\"Date from can only be earilier than date to\");return;}setDateFrom(value);};var onDateToChange=function onDateToChange(value){if(category===\"Visit\"){setDateFrom(value);}if(value<dateFrom&&dateFrom!==\"\"){alert(\"Date to can only be later than date from\");return;}setDateTo(value);};var searchLocation=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(searchTerm!==\"\")){_context.next=5;break;}_context.next=3;return request(\"searchLocation\",{locationTerm:searchTerm});case 3:_result=_context.sent;if(_result!=\"Error\"){// console.log(result)\nsetResult(_result);}else{alert(\"No matching record\");}case 5:case\"end\":return _context.stop();}}},_callee);}));return function searchLocation(){return _ref.apply(this,arguments);};}();var onDeleteRow=function onDeleteRow(){if(props.onDeleteRow()){setDeleted(true);}};useEffect(function(){if(selectLocation){setLocation(selectLocation);setSelectLocation(null);setResult(\"\");}},[selectLocation]);useEffect(function(){var locationData={category:category,dateFrom:dateFrom,dateTo:dateTo,location:location};// console.log(locationData)\nprops.onRecordChange(locationData);},[category,dateFrom,dateTo,location]);var sample=[1,2,3,4];return/*#__PURE__*/_jsx(_Fragment,{children:!deleted&&/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{className:\"category\",value:category,onChange:function onChange(e){return setCategory(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"Residence\",children:\"Residence\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Workplace\",children:\"Workplace\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Visit\",children:\"Visit\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"dateFrom\",value:dateFrom,onChange:function onChange(e){return onDateFromChange(e.target.value);}})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"dateTo\",value:dateTo,onChange:function onChange(e){return onDateToChange(e.target.value);}})}),/*#__PURE__*/_jsx(\"td\",{className:classes.locationBox,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.searchContainer,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:searchTerm,onChange:function onChange(e){return setSearchTerm(e.target.value);}}),/*#__PURE__*/_jsx(\"i\",{className:cn(\"fa fa-search\",classes.searchBtn),onClick:searchLocation}),result!==\"\"&&!selectLocation&&/*#__PURE__*/_jsx(\"div\",{className:classes.dropDown,children:result.map(function(i){return/*#__PURE__*/_jsxs(\"div\",{className:classes.resultRow,onClick:function onClick(){setSelectLocation(i);setSearchTerm(i.nameEN);},children:[/*#__PURE__*/_jsx(\"div\",{className:classes.placeName,children:i.nameEN}),/*#__PURE__*/_jsx(\"div\",{className:classes.address,children:i.addressEN})]});})})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"i\",{className:cn(classes.closeBtn,\"fa fa-window-close\"),onClick:onDeleteRow})})]})});};var LocationInfo=function LocationInfo(props){var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),page=_useState18[0],setPage=_useState18[1];var classes=useInputFormStyle();var blankrecord={category:\"Residence\",dateFrom:\"\",dateTo:\"\",location:null,result:[]};var _useState19=useState(props.locationRecord),_useState20=_slicedToArray(_useState19,2),locationRecord=_useState20[0],setLocationRecord=_useState20[1];var addRecord=function addRecord(){var last;for(var i=locationRecord.length-1;i>=0;i--){if(locationRecord[i]){last=locationRecord[i];break;}}var _last=last,dateFrom=_last.dateFrom,dateTo=_last.dateTo,location=_last.location;if(dateFrom===\"\"||dateTo===\"\"||!location){alert(\"Missing some fields\");}else{var entry=_objectSpread({},blankrecord);setLocationRecord(function(locationRecord){return locationRecord.concat(entry);});}};console.log(locationRecord);var _onDeleteRow=function onDeleteRow(i){var a=_.filter(locationRecord,function(i){if(!i)return false;else{var _dateFrom=i.dateFrom,_dateTo=i.dateTo,_location=i.location;return!(_dateFrom===\"\"||_dateTo===\"\"||!_location);}});var _locationRecord$i=locationRecord[i],dateFrom=_locationRecord$i.dateFrom,dateTo=_locationRecord$i.dateTo,location=_locationRecord$i.location;var b=locationRecord.length>1;console.log(a,b);if(!(a.length>1)){if((dateFrom===\"\"||dateTo===\"\"||!location)&&b){var _old=_toConsumableArray(locationRecord);_old[i]=null;setLocationRecord(_old);return true;}alert(\"You need at least one location record\");return false;}var old=_toConsumableArray(locationRecord);old[i]=null;setLocationRecord(old);return true;};var _onRecordChange=function onRecordChange(location,i){var old=_toConsumableArray(locationRecord);old[i]=location;setLocationRecord(old);};var submit=function submit(){var a=locationRecord.some(function(i){if(i){var dateFrom=i.dateFrom,dateTo=i.dateTo,location=i.location;return dateFrom===\"\"||dateTo===\"\"||!location;}return false;});if(a){alert(\"Missing some fields\");}else{props.submitForm(locationRecord);}};return/*#__PURE__*/_jsxs(\"div\",{className:classes.root,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.selectionTitle,children:\"Add Location Record\"}),/*#__PURE__*/_jsxs(\"table\",{className:classes.empTable,children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Category\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date From\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date To\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Delete\"})]}),/*#__PURE__*/_jsx(\"tbody\",{children:locationRecord.map(function(val,idx){if(val)return/*#__PURE__*/_jsx(LocationRecord,{onRecordChange:function onRecordChange(location){return _onRecordChange(location,idx);},onDeleteRow:function onDeleteRow(){return _onDeleteRow(idx);},data:locationRecord[idx]});return/*#__PURE__*/_jsx(_Fragment,{});})})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.BtnContainer,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.backBtn,onClick:function onClick(){return props.onPageChange(0,null,locationRecord);},children:\"Back\"}),/*#__PURE__*/_jsx(\"div\",{className:classes.addBtn,onClick:addRecord,children:\"Add\"}),/*#__PURE__*/_jsx(\"div\",{className:classes.submitBtn,onClick:function onClick(){submit();},children:\"Submit\"})]})]});};export default LocationInfo;","map":{"version":3,"sources":["/Users/johnny/hotzone/frontend/src/components/Views/LocationInfo.js"],"names":["React","useEffect","useState","render","createUseStyles","cn","useRootState","request","ClickAway","_","useInputFormStyle","root","width","display","flexDirection","justifyContent","paddingLeft","position","selectionTitle","fontSize","borderBottom","fontWeight","marginBottom","selectionField","selectionLabel","nextPage","cursor","textDecoration","bottom","right","searchBtn","marginLeft","locationBox","backBtn","marginTop","height","color","alignItems","borderRadius","left","border","submitBtn","addBtn","backgroundColor","closeBtn","searchContainer","BtnContainer","resultRow","placeName","address","dropDown","maxHeight","overflowY","zIndex","LocationRecord","props","classes","data","category","setCategory","dateFrom","setDateFrom","dateTo","setDateTo","location","nameEN","searchTerm","setSearchTerm","result","setResult","deleted","setDeleted","selectLocation","setSelectLocation","setLocation","onDateFromChange","value","alert","onDateToChange","searchLocation","locationTerm","onDeleteRow","locationData","onRecordChange","sample","e","target","map","i","addressEN","LocationInfo","page","setPage","blankrecord","locationRecord","setLocationRecord","addRecord","last","length","entry","concat","console","log","a","filter","b","old","submit","some","submitForm","empTable","val","idx","onPageChange"],"mappings":"03BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,MAAT,KAAuB,WAAvB,CACA,OAASC,eAAT,KAAgC,WAAhC,CACA,MAAOC,CAAAA,EAAP,KAAe,YAAf,CACA,OAASC,YAAT,KAA6B,UAA7B,CACA,OAASC,OAAT,KAAwB,cAAxB,CACA,MAAOC,CAAAA,SAAP,KAAsB,8BAAtB,CACA,MAAOC,CAAAA,CAAP,KAAc,QAAd,CACA,GAAMC,CAAAA,iBAAiB,CAAGN,eAAe,CAAC,CACxCO,IAAI,CAAE,CACJC,KAAK,CAAE,MADH,CAEJC,OAAO,CAAE,MAFL,CAGJC,aAAa,CAAE,QAHX,CAIJC,cAAc,CAAE,YAJZ,CAKJC,WAAW,CAAE,EALT,CAMJC,QAAQ,CAAE,UANN,CADkC,CASxCC,cAAc,CAAE,CACdN,KAAK,CAAE,MADO,CAEdO,QAAQ,CAAE,EAFI,CAGdC,YAAY,CAAE,iBAHA,CAIdC,UAAU,CAAE,GAJE,CAKdC,YAAY,CAAE,EALA,CATwB,CAgBxCC,cAAc,CAAE,CACdV,OAAO,CAAE,MADK,CAhBwB,CAmBxCW,cAAc,CAAE,CACdL,QAAQ,CAAE,EADI,CAnBwB,CAsBxCM,QAAQ,CAAE,CACRC,MAAM,CAAE,SADA,CAERC,cAAc,CAAE,YAFR,CAGRV,QAAQ,CAAE,UAHF,CAIRW,MAAM,CAAE,CAJA,CAKRC,KAAK,CAAE,EALC,CAtB8B,CA6BxCC,SAAS,CAAE,CACTC,UAAU,CAAE,EADH,CAETL,MAAM,CAAE,SAFC,CA7B6B,CAiCxCM,WAAW,CAAE,EAjC2B,CAkCxCC,OAAO,CAAE,CACPC,SAAS,CAAE,EADJ,CAEPtB,KAAK,CAAE,EAFA,CAGPuB,MAAM,CAAE,EAHD,CAIPC,KAAK,CAAE,OAJA,CAKPvB,OAAO,CAAE,MALF,CAMPE,cAAc,CAAE,QANT,CAOPsB,UAAU,CAAE,QAPL,CAQPhB,UAAU,CAAE,MARL,CASPK,MAAM,CAAE,SATD,CAUPP,QAAQ,CAAE,EAVH,CAWPmB,YAAY,CAAE,CAXP,CAYPrB,QAAQ,CAAE,UAZH,CAaPsB,IAAI,CAAE,CAbC,CAcPC,MAAM,CAAE,iBAdD,CAlC+B,CAkDxCC,SAAS,CAAE,CACTP,SAAS,CAAE,EADF,CAETtB,KAAK,CAAE,EAFE,CAGTuB,MAAM,CAAE,EAHC,CAITC,KAAK,CAAE,OAJE,CAKTvB,OAAO,CAAE,MALA,CAMTE,cAAc,CAAE,QANP,CAOTsB,UAAU,CAAE,QAPH,CAQThB,UAAU,CAAE,MARH,CASTK,MAAM,CAAE,SATC,CAUTP,QAAQ,CAAE,EAVD,CAWTmB,YAAY,CAAE,CAXL,CAYTrB,QAAQ,CAAE,UAZD,CAaTY,KAAK,CAAE,EAbE,CAcTW,MAAM,CAAE,iBAdC,CAlD6B,CAkExCE,MAAM,CAAE,CACNR,SAAS,CAAE,EADL,CAENtB,KAAK,CAAE,GAFD,CAGNuB,MAAM,CAAE,EAHF,CAINC,KAAK,CAAE,OAJD,CAKNO,eAAe,CAAE,OALX,CAMN9B,OAAO,CAAE,MANH,CAONE,cAAc,CAAE,QAPV,CAQNsB,UAAU,CAAE,QARN,CASNhB,UAAU,CAAE,MATN,CAUNK,MAAM,CAAE,SAVF,CAWNP,QAAQ,CAAE,EAXJ,CAYNmB,YAAY,CAAE,CAZR,CAlEgC,CAgFxCM,QAAQ,CAAE,CACRlB,MAAM,CAAE,SADA,CAhF8B,CAmFxCmB,eAAe,CAAE,CACf5B,QAAQ,CAAE,UADK,CAnFuB,CAsFxC6B,YAAY,CAAE,CACZjC,OAAO,CAAE,MADG,CAEZE,cAAc,CAAE,QAFJ,CAGZE,QAAQ,CAAE,UAHE,CAtF0B,CA2FxC8B,SAAS,CAAE,CACTlC,OAAO,CAAE,MADA,CAETC,aAAa,CAAE,QAFN,CAGT0B,MAAM,CAAE,iBAHC,CAITd,MAAM,CAAE,SAJC,CAKT,UAAW,CAAEiB,eAAe,CAAE,MAAnB,CALF,CA3F6B,CAkGxCK,SAAS,CAAE,CACT3B,UAAU,CAAE,MADH,CAlG6B,CAqGxC4B,OAAO,CAAE,CACP9B,QAAQ,CAAE,EADH,CArG+B,CAwGxC+B,QAAQ,CAAE,CACRjC,QAAQ,CAAE,UADF,CAERkC,SAAS,CAAE,GAFH,CAGRC,SAAS,CAAE,QAHH,CAIRvC,OAAO,CAAE,MAJD,CAKRC,aAAa,CAAE,QALP,CAMR0B,MAAM,CAAE,iBANA,CAORG,eAAe,CAAE,OAPT,CAQR,UAAW,CACT3B,WAAW,CAAE,EADJ,CARH,CAWRqC,MAAM,CAAE,CAXA,CAxG8B,CAAD,CAAzC,CAsHA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,KAAD,CAAW,CAChC,GAAMC,CAAAA,OAAO,CAAG9C,iBAAiB,EAAjC,CADgC,cAEAR,QAAQ,CAACqD,KAAK,CAACE,IAAN,CAAWC,QAAZ,CAFR,wCAEzBA,QAFyB,eAEfC,WAFe,8BAGAzD,QAAQ,CAACqD,KAAK,CAACE,IAAN,CAAWG,QAAZ,CAHR,yCAGzBA,QAHyB,eAGfC,WAHe,8BAIJ3D,QAAQ,CAACqD,KAAK,CAACE,IAAN,CAAWK,MAAZ,CAJJ,yCAIzBA,MAJyB,eAIjBC,SAJiB,8BAKI7D,QAAQ,CAC1CqD,KAAK,CAACE,IAAN,CAAWO,QAAX,CAAsBT,KAAK,CAACE,IAAN,CAAWO,QAAX,CAAoBC,MAA1C,CAAmD,EADT,CALZ,yCAKzBC,UALyB,eAKbC,aALa,8BAQJjE,QAAQ,CAAC,EAAD,CARJ,0CAQzBkE,MARyB,gBAQjBC,SARiB,gCASFnE,QAAQ,CAAC,KAAD,CATN,2CASzBoE,OATyB,gBAShBC,UATgB,gCAUYrE,QAAQ,CAACqD,KAAK,CAACE,IAAN,CAAWO,QAAZ,CAVpB,2CAUzBQ,cAVyB,gBAUTC,iBAVS,gCAWAvE,QAAQ,CAAC,IAAD,CAXR,2CAWzB8D,QAXyB,gBAWfU,WAXe,gBAahC,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,KAAD,CAAW,CAClC,GAAIlB,QAAQ,GAAK,OAAjB,CAA0B,CACxBK,SAAS,CAACa,KAAD,CAAT,CACD,CACD,GAAIA,KAAK,CAAGd,MAAR,EAAkBA,MAAM,GAAK,EAAjC,CAAqC,CACnCe,KAAK,CAAC,6CAAD,CAAL,CACA,OACD,CACDhB,WAAW,CAACe,KAAD,CAAX,CACD,CATD,CAUA,GAAME,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACF,KAAD,CAAW,CAChC,GAAIlB,QAAQ,GAAK,OAAjB,CAA0B,CACxBG,WAAW,CAACe,KAAD,CAAX,CACD,CACD,GAAIA,KAAK,CAAGhB,QAAR,EAAoBA,QAAQ,GAAK,EAArC,CAAyC,CACvCiB,KAAK,CAAC,0CAAD,CAAL,CACA,OACD,CACDd,SAAS,CAACa,KAAD,CAAT,CACD,CATD,CAUA,GAAMG,CAAAA,cAAc,0FAAG,oJACjBb,UAAU,GAAK,EADE,gDAEE3D,CAAAA,OAAO,CAAC,gBAAD,CAAmB,CAC7CyE,YAAY,CAAEd,UAD+B,CAAnB,CAFT,QAEbE,OAFa,eAKnB,GAAIA,OAAM,EAAI,OAAd,CAAuB,CACrB;AACAC,SAAS,CAACD,OAAD,CAAT,CACD,CAHD,IAGO,CACLS,KAAK,CAAC,oBAAD,CAAL,CACD,CAVkB,sDAAH,kBAAdE,CAAAA,cAAc,0CAApB,CAcA,GAAME,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxB,GAAI1B,KAAK,CAAC0B,WAAN,EAAJ,CAAyB,CACvBV,UAAU,CAAC,IAAD,CAAV,CACD,CACF,CAJD,CAKAtE,SAAS,CAAC,UAAM,CACd,GAAIuE,cAAJ,CAAoB,CAClBE,WAAW,CAACF,cAAD,CAAX,CACAC,iBAAiB,CAAC,IAAD,CAAjB,CACAJ,SAAS,CAAC,EAAD,CAAT,CACD,CACF,CANQ,CAMN,CAACG,cAAD,CANM,CAAT,CAQAvE,SAAS,CAAC,UAAM,CACd,GAAMiF,CAAAA,YAAY,CAAG,CAAExB,QAAQ,CAARA,QAAF,CAAYE,QAAQ,CAARA,QAAZ,CAAsBE,MAAM,CAANA,MAAtB,CAA8BE,QAAQ,CAARA,QAA9B,CAArB,CACA;AACAT,KAAK,CAAC4B,cAAN,CAAqBD,YAArB,EACD,CAJQ,CAIN,CAACxB,QAAD,CAAWE,QAAX,CAAqBE,MAArB,CAA6BE,QAA7B,CAJM,CAAT,CAMA,GAAMoB,CAAAA,MAAM,CAAG,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAAf,CACA,mBACE,yBACG,CAACd,OAAD,eACC,mCACE,iCACE,gBACE,SAAS,CAAC,UADZ,CAEE,KAAK,CAAEZ,QAFT,CAGE,QAAQ,CAAE,kBAAC2B,CAAD,QAAO1B,CAAAA,WAAW,CAAC0B,CAAC,CAACC,MAAF,CAASV,KAAV,CAAlB,EAHZ,wBAKE,eAAQ,KAAK,CAAC,WAAd,uBALF,cAME,eAAQ,KAAK,CAAC,WAAd,uBANF,cAOE,eAAQ,KAAK,CAAC,OAAd,mBAPF,GADF,EADF,cAYE,iCACE,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,UAFZ,CAGE,KAAK,CAAEhB,QAHT,CAIE,QAAQ,CAAE,kBAACyB,CAAD,QAAOV,CAAAA,gBAAgB,CAACU,CAAC,CAACC,MAAF,CAASV,KAAV,CAAvB,EAJZ,EADF,EAZF,cAoBE,iCACE,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,QAFZ,CAGE,KAAK,CAAEd,MAHT,CAIE,QAAQ,CAAE,kBAACuB,CAAD,QAAOP,CAAAA,cAAc,CAACO,CAAC,CAACC,MAAF,CAASV,KAAV,CAArB,EAJZ,EADF,EApBF,cA4BE,WAAI,SAAS,CAAEpB,OAAO,CAACxB,WAAvB,uBACE,aAAK,SAAS,CAAEwB,OAAO,CAACX,eAAxB,wBACE,cACE,IAAI,CAAC,MADP,CAEE,KAAK,CAAEqB,UAFT,CAGE,QAAQ,CAAE,kBAACmB,CAAD,QAAOlB,CAAAA,aAAa,CAACkB,CAAC,CAACC,MAAF,CAASV,KAAV,CAApB,EAHZ,EADF,cAME,UACE,SAAS,CAAEvE,EAAE,CAAC,cAAD,CAAiBmD,OAAO,CAAC1B,SAAzB,CADf,CAEE,OAAO,CAAEiD,cAFX,EANF,CAWGX,MAAM,GAAK,EAAX,EAAiB,CAACI,cAAlB,eACC,YAAK,SAAS,CAAEhB,OAAO,CAACN,QAAxB,UACGkB,MAAM,CAACmB,GAAP,CAAW,SAACC,CAAD,qBACV,aACE,SAAS,CAAEhC,OAAO,CAACT,SADrB,CAEE,OAAO,CAAE,kBAAM,CACb0B,iBAAiB,CAACe,CAAD,CAAjB,CACArB,aAAa,CAACqB,CAAC,CAACvB,MAAH,CAAb,CACD,CALH,wBAOE,YAAK,SAAS,CAAET,OAAO,CAACR,SAAxB,UAAoCwC,CAAC,CAACvB,MAAtC,EAPF,cAQE,YAAK,SAAS,CAAET,OAAO,CAACP,OAAxB,UAAkCuC,CAAC,CAACC,SAApC,EARF,GADU,EAAX,CADH,EAZJ,GADF,EA5BF,cA0DE,iCACE,UACE,SAAS,CAAEpF,EAAE,CAACmD,OAAO,CAACZ,QAAT,CAAmB,oBAAnB,CADf,CAEE,OAAO,CAAEqC,WAFX,EADF,EA1DF,GAFJ,EADF,CAuED,CA1ID,CA4IA,GAAMS,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACnC,KAAD,CAAW,iBACNrD,QAAQ,CAAC,CAAD,CADF,2CACvByF,IADuB,gBACjBC,OADiB,gBAE9B,GAAMpC,CAAAA,OAAO,CAAG9C,iBAAiB,EAAjC,CACA,GAAMmF,CAAAA,WAAW,CAAG,CAClBnC,QAAQ,CAAE,WADQ,CAElBE,QAAQ,CAAE,EAFQ,CAGlBE,MAAM,CAAE,EAHU,CAIlBE,QAAQ,CAAE,IAJQ,CAKlBI,MAAM,CAAE,EALU,CAApB,CAH8B,gBAUclE,QAAQ,CAACqD,KAAK,CAACuC,cAAP,CAVtB,2CAUvBA,cAVuB,gBAUPC,iBAVO,gBAW9B,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtB,GAAIC,CAAAA,IAAJ,CACA,IAAK,GAAIT,CAAAA,CAAC,CAAGM,cAAc,CAACI,MAAf,CAAwB,CAArC,CAAwCV,CAAC,EAAI,CAA7C,CAAgDA,CAAC,EAAjD,CAAqD,CACnD,GAAIM,cAAc,CAACN,CAAD,CAAlB,CAAuB,CACrBS,IAAI,CAAGH,cAAc,CAACN,CAAD,CAArB,CACA,MACD,CACF,CAPqB,UAQiBS,IARjB,CAQdrC,QARc,OAQdA,QARc,CAQJE,MARI,OAQJA,MARI,CAQIE,QARJ,OAQIA,QARJ,CAStB,GAAIJ,QAAQ,GAAK,EAAb,EAAmBE,MAAM,GAAK,EAA9B,EAAoC,CAACE,QAAzC,CAAmD,CACjDa,KAAK,CAAC,qBAAD,CAAL,CACD,CAFD,IAEO,CACL,GAAMsB,CAAAA,KAAK,kBAAQN,WAAR,CAAX,CACAE,iBAAiB,CAAC,SAACD,cAAD,QAAoBA,CAAAA,cAAc,CAACM,MAAf,CAAsBD,KAAtB,CAApB,EAAD,CAAjB,CACD,CACF,CAfD,CAiBAE,OAAO,CAACC,GAAR,CAAYR,cAAZ,EAEA,GAAMb,CAAAA,YAAW,CAAG,QAAdA,CAAAA,WAAc,CAACO,CAAD,CAAO,CACzB,GAAMe,CAAAA,CAAC,CAAG9F,CAAC,CAAC+F,MAAF,CAASV,cAAT,CAAyB,SAACN,CAAD,CAAO,CACxC,GAAI,CAACA,CAAL,CAAQ,MAAO,MAAP,CAAR,IACK,IACK5B,CAAAA,SADL,CACoC4B,CADpC,CACK5B,QADL,CACeE,OADf,CACoC0B,CADpC,CACe1B,MADf,CACuBE,SADvB,CACoCwB,CADpC,CACuBxB,QADvB,CAEH,MAAO,EAAEJ,SAAQ,GAAK,EAAb,EAAmBE,OAAM,GAAK,EAA9B,EAAoC,CAACE,SAAvC,CAAP,CACD,CACF,CANS,CAAV,CADyB,sBAQc8B,cAAc,CAACN,CAAD,CAR5B,CAQjB5B,QARiB,mBAQjBA,QARiB,CAQPE,MARO,mBAQPA,MARO,CAQCE,QARD,mBAQCA,QARD,CASzB,GAAMyC,CAAAA,CAAC,CAAGX,cAAc,CAACI,MAAf,CAAwB,CAAlC,CAEAG,OAAO,CAACC,GAAR,CAAYC,CAAZ,CAAeE,CAAf,EACA,GAAI,EAAEF,CAAC,CAACL,MAAF,CAAW,CAAb,CAAJ,CAAqB,CACnB,GAAI,CAACtC,QAAQ,GAAK,EAAb,EAAmBE,MAAM,GAAK,EAA9B,EAAoC,CAACE,QAAtC,GAAmDyC,CAAvD,CAA0D,CACxD,GAAIC,CAAAA,IAAG,oBAAOZ,cAAP,CAAP,CACAY,IAAG,CAAClB,CAAD,CAAH,CAAS,IAAT,CACAO,iBAAiB,CAACW,IAAD,CAAjB,CACA,MAAO,KAAP,CACD,CACD7B,KAAK,CAAC,uCAAD,CAAL,CACA,MAAO,MAAP,CACD,CACD,GAAI6B,CAAAA,GAAG,oBAAOZ,cAAP,CAAP,CACAY,GAAG,CAAClB,CAAD,CAAH,CAAS,IAAT,CACAO,iBAAiB,CAACW,GAAD,CAAjB,CACA,MAAO,KAAP,CACD,CA1BD,CA4BA,GAAMvB,CAAAA,eAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACnB,QAAD,CAAWwB,CAAX,CAAiB,CACtC,GAAIkB,CAAAA,GAAG,oBAAOZ,cAAP,CAAP,CACAY,GAAG,CAAClB,CAAD,CAAH,CAASxB,QAAT,CACA+B,iBAAiB,CAACW,GAAD,CAAjB,CACD,CAJD,CAMA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACnB,GAAMJ,CAAAA,CAAC,CAAGT,cAAc,CAACc,IAAf,CAAoB,SAAApB,CAAC,CAAI,CACjC,GAAGA,CAAH,CAAK,IACK5B,CAAAA,QADL,CACoC4B,CADpC,CACK5B,QADL,CACeE,MADf,CACoC0B,CADpC,CACe1B,MADf,CACuBE,QADvB,CACoCwB,CADpC,CACuBxB,QADvB,CAEH,MAAQJ,CAAAA,QAAQ,GAAK,EAAb,EAAmBE,MAAM,GAAK,EAA9B,EAAoC,CAACE,QAA7C,CACD,CACD,MAAO,MAAP,CACD,CANS,CAAV,CAOA,GAAIuC,CAAJ,CAAO,CACL1B,KAAK,CAAC,qBAAD,CAAL,CACD,CAFD,IAEO,CACLtB,KAAK,CAACsD,UAAN,CAAiBf,cAAjB,EACD,CACF,CAbD,CAeA,mBACE,aAAK,SAAS,CAAEtC,OAAO,CAAC7C,IAAxB,wBACE,YAAK,SAAS,CAAE6C,OAAO,CAACtC,cAAxB,iCADF,cAEE,eAAO,SAAS,CAAEsC,OAAO,CAACsD,QAA1B,wBACE,mCACE,gCADF,cAEE,iCAFF,cAGE,+BAHF,cAIE,gCAJF,cAKE,8BALF,GADF,cAQE,uBACGhB,cAAc,CAACP,GAAf,CAAmB,SAACwB,GAAD,CAAMC,GAAN,CAAc,CAChC,GAAID,GAAJ,CACE,mBACE,KAAC,cAAD,EACE,cAAc,CAAE,wBAAC/C,QAAD,QAAcmB,CAAAA,eAAc,CAACnB,QAAD,CAAWgD,GAAX,CAA5B,EADlB,CAEE,WAAW,CAAE,6BAAM/B,CAAAA,YAAW,CAAC+B,GAAD,CAAjB,EAFf,CAGE,IAAI,CAAElB,cAAc,CAACkB,GAAD,CAHtB,EADF,CAOF,mBAAO,kBAAP,CACD,CAVA,CADH,EARF,GAFF,cAwBE,aAAK,SAAS,CAAExD,OAAO,CAACV,YAAxB,wBACE,YACE,SAAS,CAAEU,OAAO,CAACvB,OADrB,CAEE,OAAO,CAAE,yBAAMsB,CAAAA,KAAK,CAAC0D,YAAN,CAAmB,CAAnB,CAAsB,IAAtB,CAA4BnB,cAA5B,CAAN,EAFX,kBADF,cAQE,YAAK,SAAS,CAAEtC,OAAO,CAACd,MAAxB,CAAgC,OAAO,CAAEsD,SAAzC,iBARF,cAWE,YACE,SAAS,CAAExC,OAAO,CAACf,SADrB,CAEE,OAAO,CAAE,kBAAM,CACbkE,MAAM,GACP,CAJH,oBAXF,GAxBF,GADF,CA+CD,CA9HD,CAgIA,cAAejB,CAAAA,YAAf","sourcesContent":["import React, { useEffect, useState } from \"react\"\nimport { render } from \"react-dom\"\nimport { createUseStyles } from \"react-jss\"\nimport cn from \"classnames\"\nimport { useRootState } from \"@/App.js\"\nimport { request } from \"@/request.js\"\nimport ClickAway from \"@/components/Utils/ClickAway\"\nimport _ from \"lodash\"\nconst useInputFormStyle = createUseStyles({\n  root: {\n    width: \"100%\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    justifyContent: \"flex-start\",\n    paddingLeft: 30,\n    position: \"relative\",\n  },\n  selectionTitle: {\n    width: \"100%\",\n    fontSize: 40,\n    borderBottom: \"1px solid black\",\n    fontWeight: 500,\n    marginBottom: 10,\n  },\n  selectionField: {\n    display: \"flex\",\n  },\n  selectionLabel: {\n    fontSize: 20,\n  },\n  nextPage: {\n    cursor: \"pointer\",\n    textDecoration: \" underline\",\n    position: \"absolute\",\n    bottom: 0,\n    right: 20,\n  },\n  searchBtn: {\n    marginLeft: 10,\n    cursor: \"pointer\",\n  },\n  locationBox: {},\n  backBtn: {\n    marginTop: 20,\n    width: 60,\n    height: 40,\n    color: \"black\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    fontWeight: \"bold\",\n    cursor: \"pointer\",\n    fontSize: 15,\n    borderRadius: 5,\n    position: \"absolute\",\n    left: 0,\n    border: \"1px solid black\",\n  },\n  submitBtn: {\n    marginTop: 20,\n    width: 60,\n    height: 40,\n    color: \"black\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    fontWeight: \"bold\",\n    cursor: \"pointer\",\n    fontSize: 15,\n    borderRadius: 5,\n    position: \"absolute\",\n    right: 30,\n    border: \"1px solid black\",\n  },\n  addBtn: {\n    marginTop: 20,\n    width: 150,\n    height: 40,\n    color: \"white\",\n    backgroundColor: \"black\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    fontWeight: \"bold\",\n    cursor: \"pointer\",\n    fontSize: 18,\n    borderRadius: 5,\n  },\n  closeBtn: {\n    cursor: \"pointer\",\n  },\n  searchContainer: {\n    position: \"relative\",\n  },\n  BtnContainer: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    position: \"relative\",\n  },\n  resultRow: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    border: \"1px solid black\",\n    cursor: \"pointer\",\n    \"&:hover\": { backgroundColor: \"grey\" },\n  },\n  placeName: {\n    fontWeight: \"bold\",\n  },\n  address: {\n    fontSize: 13,\n  },\n  dropDown: {\n    position: \"absolute\",\n    maxHeight: 500,\n    overflowY: \"scroll\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    border: \"1px solid black\",\n    backgroundColor: \"white\",\n    \"& > div\": {\n      paddingLeft: 10,\n    },\n    zIndex: 1,\n  },\n})\nconst LocationRecord = (props) => {\n  const classes = useInputFormStyle()\n  const [category, setCategory] = useState(props.data.category)\n  const [dateFrom, setDateFrom] = useState(props.data.dateFrom)\n  const [dateTo, setDateTo] = useState(props.data.dateTo)\n  const [searchTerm, setSearchTerm] = useState(\n    props.data.location ? props.data.location.nameEN : \"\"\n  )\n  const [result, setResult] = useState(\"\")\n  const [deleted, setDeleted] = useState(false)\n  const [selectLocation, setSelectLocation] = useState(props.data.location)\n  const [location, setLocation] = useState(null)\n\n  const onDateFromChange = (value) => {\n    if (category === \"Visit\") {\n      setDateTo(value)\n    }\n    if (value > dateTo && dateTo !== \"\") {\n      alert(\"Date from can only be earilier than date to\")\n      return\n    }\n    setDateFrom(value)\n  }\n  const onDateToChange = (value) => {\n    if (category === \"Visit\") {\n      setDateFrom(value)\n    }\n    if (value < dateFrom && dateFrom !== \"\") {\n      alert(\"Date to can only be later than date from\")\n      return\n    }\n    setDateTo(value)\n  }\n  const searchLocation = async () => {\n    if (searchTerm !== \"\") {\n      const result = await request(\"searchLocation\", {\n        locationTerm: searchTerm,\n      })\n      if (result != \"Error\") {\n        // console.log(result)\n        setResult(result)\n      } else {\n        alert(\"No matching record\")\n      }\n    }\n  }\n\n  const onDeleteRow = () => {\n    if (props.onDeleteRow()) {\n      setDeleted(true)\n    }\n  }\n  useEffect(() => {\n    if (selectLocation) {\n      setLocation(selectLocation)\n      setSelectLocation(null)\n      setResult(\"\")\n    }\n  }, [selectLocation])\n\n  useEffect(() => {\n    const locationData = { category, dateFrom, dateTo, location }\n    // console.log(locationData)\n    props.onRecordChange(locationData)\n  }, [category, dateFrom, dateTo, location])\n\n  const sample = [1, 2, 3, 4]\n  return (\n    <>\n      {!deleted && (\n        <tr>\n          <td>\n            <select\n              className=\"category\"\n              value={category}\n              onChange={(e) => setCategory(e.target.value)}\n            >\n              <option value=\"Residence\">Residence</option>\n              <option value=\"Workplace\">Workplace</option>\n              <option value=\"Visit\">Visit</option>\n            </select>\n          </td>\n          <td>\n            <input\n              type=\"date\"\n              className=\"dateFrom\"\n              value={dateFrom}\n              onChange={(e) => onDateFromChange(e.target.value)}\n            />\n          </td>\n          <td>\n            <input\n              type=\"date\"\n              className=\"dateTo\"\n              value={dateTo}\n              onChange={(e) => onDateToChange(e.target.value)}\n            />\n          </td>\n          <td className={classes.locationBox}>\n            <div className={classes.searchContainer}>\n              <input\n                type=\"text\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n              />\n              <i\n                className={cn(\"fa fa-search\", classes.searchBtn)}\n                onClick={searchLocation}\n              ></i>\n\n              {result !== \"\" && !selectLocation && (\n                <div className={classes.dropDown}>\n                  {result.map((i) => (\n                    <div\n                      className={classes.resultRow}\n                      onClick={() => {\n                        setSelectLocation(i)\n                        setSearchTerm(i.nameEN)\n                      }}\n                    >\n                      <div className={classes.placeName}>{i.nameEN}</div>\n                      <div className={classes.address}>{i.addressEN}</div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </td>\n          <td>\n            <i\n              className={cn(classes.closeBtn, \"fa fa-window-close\")}\n              onClick={onDeleteRow}\n            ></i>\n          </td>\n        </tr>\n      )}\n    </>\n  )\n}\n\nconst LocationInfo = (props) => {\n  const [page, setPage] = useState(0)\n  const classes = useInputFormStyle()\n  const blankrecord = {\n    category: \"Residence\",\n    dateFrom: \"\",\n    dateTo: \"\",\n    location: null,\n    result: [],\n  }\n  const [locationRecord, setLocationRecord] = useState(props.locationRecord)\n  const addRecord = () => {\n    let last\n    for (let i = locationRecord.length - 1; i >= 0; i--) {\n      if (locationRecord[i]) {\n        last = locationRecord[i]\n        break\n      }\n    }\n    const { dateFrom, dateTo, location } = last\n    if (dateFrom === \"\" || dateTo === \"\" || !location) {\n      alert(\"Missing some fields\")\n    } else {\n      const entry = { ...blankrecord }\n      setLocationRecord((locationRecord) => locationRecord.concat(entry))\n    }\n  }\n\n  console.log(locationRecord)\n\n  const onDeleteRow = (i) => {\n    const a = _.filter(locationRecord, (i) => {\n      if (!i) return false\n      else {\n        const { dateFrom, dateTo, location } = i\n        return !(dateFrom === \"\" || dateTo === \"\" || !location)\n      }\n    })\n    const { dateFrom, dateTo, location } = locationRecord[i]\n    const b = locationRecord.length > 1\n\n    console.log(a, b)\n    if (!(a.length > 1)) {\n      if ((dateFrom === \"\" || dateTo === \"\" || !location) && b) {\n        let old = [...locationRecord]\n        old[i] = null\n        setLocationRecord(old)\n        return true\n      }\n      alert(\"You need at least one location record\")\n      return false\n    }\n    let old = [...locationRecord]\n    old[i] = null\n    setLocationRecord(old)\n    return true\n  }\n\n  const onRecordChange = (location, i) => {\n    let old = [...locationRecord]\n    old[i] = location\n    setLocationRecord(old)\n  }\n\n  const submit = () => {\n    const a = locationRecord.some(i => {\n      if(i){\n        const { dateFrom, dateTo, location } = i\n        return (dateFrom === \"\" || dateTo === \"\" || !location) \n      }\n      return false\n    })\n    if (a) {\n      alert(\"Missing some fields\")\n    } else {\n      props.submitForm(locationRecord)\n    }\n  }\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.selectionTitle}>Add Location Record</div>\n      <table className={classes.empTable}>\n        <tr>\n          <th>Category</th>\n          <th>Date From</th>\n          <th>Date To</th>\n          <th>Location</th>\n          <th>Delete</th>\n        </tr>\n        <tbody>\n          {locationRecord.map((val, idx) => {\n            if (val)\n              return (\n                <LocationRecord\n                  onRecordChange={(location) => onRecordChange(location, idx)}\n                  onDeleteRow={() => onDeleteRow(idx)}\n                  data={locationRecord[idx]}\n                />\n              )\n            return <></>\n          })}\n        </tbody>\n      </table>\n      <div className={classes.BtnContainer}>\n        <div\n          className={classes.backBtn}\n          onClick={() => props.onPageChange(0, null, locationRecord)}\n        >\n          Back\n        </div>\n\n        <div className={classes.addBtn} onClick={addRecord}>\n          Add\n        </div>\n        <div\n          className={classes.submitBtn}\n          onClick={() => {\n            submit()\n          }}\n        >\n          Submit\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default LocationInfo\n"]},"metadata":{},"sourceType":"module"}